from sqlalchemy.orm import Session

from app.database.models import detection as models
from app.database.schemas import detection as schemas

def get_job_by_gl_job_id(db: Session, gl_job_id: int):
  return db.query(models.Job).filter(models.Job.gl_gl_job_id == gl_job_id).first()



def create_job(db: Session, job: schemas.JobCreate):
  db_job = models.Job(
    gl_project_dir=job.gl_project_dir,
    gl_commit_sha=job.gl_commit_sha,
    gl_commit_ref_name=job.gl_commit_ref_name,
    gl_project_id=job.gl_project_id,
    gl_job_id=job.gl_job_id,
    diff=job.diff
  )
  db.add(db_job)
  db.commit()
  db.refresh(db_job)
  return db_job
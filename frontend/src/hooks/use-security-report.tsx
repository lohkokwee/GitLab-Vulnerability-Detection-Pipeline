import useSWR from "swr";

import {
  GET_REPORT_BY_DB_JOB_ID,
  GET_REPORT_BY_GL_JOB_ID,
} from "@/constants/api/security-report"
import { fetcher } from "@/lib/fetcher"
import { ISecurityReport } from "@/types/report/security-report";

interface UseSecurityReportProps {
  dbJobId?: string,
  glJobId?: string,
}

const useSecurityReport = ({
  dbJobId = undefined,
  glJobId = undefined,
}: UseSecurityReportProps) => {
  const apiUrl = dbJobId !== undefined 
    ? `${GET_REPORT_BY_DB_JOB_ID}/${dbJobId}`
    : `${GET_REPORT_BY_GL_JOB_ID}/${glJobId}`

  const { data, error, isLoading } = useSWR<ISecurityReport>(
    apiUrl,
    fetcher,
  )

  return {
    securityReport: data,
    isError: error,
    error,
    isLoading,
  }
}

export { useSecurityReport }

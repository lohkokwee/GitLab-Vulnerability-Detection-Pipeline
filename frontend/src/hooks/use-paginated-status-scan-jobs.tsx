import * as React from "react"
import useSWR from "swr";

import {
  type PaginationState
} from "@tanstack/react-table"

import { fetcher } from "@/lib/fetcher";

import { IPaginatedResponse } from "@/types/api/paginated-response";
import { IStatusScanJob } from "@/types/workers-status/status-scan-job";
import { GET_ALL_PAGINATED_SCAN_JOBS } from "@/constants/api/workers-status";

const usePaginatedStatusScanJobs = () => {
  const [{ pageIndex, pageSize }, setPagination] = React.useState<PaginationState>({
    pageIndex: 0,
    pageSize: 10,
  })
  const pagination = React.useMemo(
    () => ({
      pageIndex,
      pageSize,
    }),
    [pageIndex, pageSize]
  )
  
  const { data, error, isLoading } = useSWR<IPaginatedResponse<IStatusScanJob>>(
    `${GET_ALL_PAGINATED_SCAN_JOBS}?page=${pageIndex + 1}&size=${pageSize}`,
    fetcher,
  )

  return {
    data,
    isError: error,
    isLoading,
    pagination,
    setPagination
  }
}

export { usePaginatedStatusScanJobs }
